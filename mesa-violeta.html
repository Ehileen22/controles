<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mesa Violeta</title>

    <link href="https://api.mapbox.com/mapbox-gl-js/v3.7.0/mapbox-gl.css" rel="stylesheet">
    <script src="https://api.mapbox.com/mapbox-gl-js/v3.7.0/mapbox-gl.js"></script>
    <script src="https://aframe.io/releases/1.7.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/aframe-physics-system@5.0.0/dist/aframe-physics-system.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/super-hands"></script>
</head>
<body>
    <a-scene webxr="optionalFeatures: hand-tracking" physics="gravity: -9.8" device-orientation-permission-ui="enabled: false">
        
        <a-sky  id="sky" src="#point1" rotation="0 -80 0"></a-sky> 
        <a-assets>
            <!--Recorrido hacia la entrada-->
            <img id="point1" src="images/GS__01_DxO.webp" alt="Imagen 1">
            <img id="point2" src="images/GS__03_DxO.webp" alt="Imagen 2">
            <img id="juridicaArea" src="images/juridica.png" alt="juridica">
            <img id="psicoArea" src="images/psico.png" alt="psicologia">
            <img id="ludicaArea" src="images/ludica.png" alt="ludica">
            <img id="socialArea" src="images/social.png" alt="social">
            <img id="point3" src="images/GS__05_DxO.webp" alt="Imagen 3">
            <!--Recepción-->
            <img id="point4" src="images/GS__07_DxO.webp" alt="Imagen 4">
            <img id="point7" src="images/GS__10_DxO.webp" alt="Imagen 7">
            <!-- Violentometro y juguetes -->
            <img id="point9" src="images/GS__14_DxO.webp" alt="Imagen 9">
            <img id="point10" src="images/GS__15_DxO.webp" alt="Imagen 10">
            <img id="point11" src="images/GS__16_DxO.webp" alt="Imagen 11">
            <!--Recursos-->
            <img id="close1" src="images/close1.png" alt="close1">
            <video id="atras" autoplay loop muted src="images/direction.webm" alt="hotspot"></video>
            <video id="adelante" autoplay loop muted src="images/adelante.webm" alt="adelante"></video>
            <video id="video" autoplay loop muted src="images/try.webm"></video>
            <img id="imgP" src="images/imgPrueba.jpg" alt="imgPrueba">
            <img id="imgPsicologica" src="images/violencia-psico.png" alt="imgPsicologica">
            <img id="imgFisica" src="images/violencia-fisica.png" alt="imgFisica">
            <img id="imgPatrimonial" src="images/violencia-patrimonial.png" alt="imgPatrimonial">
            <img id="imgEconomica" src="images/violencia-economica.png" alt="imgEconomica">
            <img id="imgSexual" src="images/violencia-sexual.png" alt="imgSexual">
        </a-assets>

        <!-- Controladores de Meta Quest -->
        <a-entity meta-touch-controls="hand: left" super-hands="maxGrabDistance: 2"
            collision-filter="group: hand; collidesWith: interactivo"></a-entity>
        <a-entity meta-touch-controls="hand: right" super-hands="maxGrabDistance: 2"
            collision-filter="group: hand; collidesWith: interactivo"></a-entity>

        <a-entity id="spots" hotspots scale="1 1 1">
            <!--Estacionamiento-->
            <a-entity id="group-point1">
                <!-- Cubo interactivo añadido aquí -->
                <a-box id="cubo" position="0 1 -2" color="red" scale="0.3 0.3 0.3" class="interactivo"
                    geometry="primitive: box" dynamic-body grabbable hoverable draggable>
                </a-box>
                
                <a-video class="adelante" spot="linkto:#point2;spotgroup:group-point2" position="0 0.2 -2.5" rotation="90 60 -35" material="opacity:0.9" src="#adelante" geometry="width: 1.8; height: 1.3" look-at="#cam"></a-video>
                <a-video id="open01" position="4 -2.5 -2" rotation="90 90 0" src="#video" material="opacity:0.8" visible="true" visibilidad="openImageId: open01; imageId: infoText; closeId: close01" geometry="width: 2.5; height: 2.5"></a-video>
                <a-entity id="infoText" position="10 0.5 -5" rotation="0.000 -50 0.000" visible="false">
                    <a-plane position="0 1 0" rotation="0 0 0" geometry="width: 10; height: 10" material="color: black; opacity: 0.8"></a-plane>
                    <a-circle position="4 5.3 0.04" id="close01" radius="0.4" material="src: #close1; opacity:1" geometry=""></a-circle>
                    <a-image src="#imgP" position="0 3.3 0.03" geometry="width: 9.2; height: 5" material=""></a-image>
                    <a-text position="0 0 0.01" value="Información" align="center" color="white" width="9.5" text="wrapCount: 30; baseline: top; negate: false;" font="https://raw.githubusercontent.com/mel091/lato-font/refs/heads/main/Lato-Regular-msdf.json"></a-text>
                    <a-text position="0 -1 0.01" value="*Dirección: Calle Carabineros/ Luis Donaldo Colosio Murrieta y Calle San Antonio, Col. Ex Base Aérea, C.P. 23050. La Paz, Baja California Sur.
                    *Teléfono: -(612) 68 81229 -(612) 68 81236 
                    *Correo: cjm.bcs.coordinacion@pgjebcs.gob.mx" align="center" color="white" width="9.5" text="wrapCount: 50; baseline: top; shader: msdf; negate: false;" font="https://raw.githubusercontent.com/mel091/lato-font/refs/heads/main/Lato-Regular-msdf.json"></a-text>
                </a-entity>
            </a-entity>

            <!-- Resto del código permanece igual -->
            <a-entity id="group-point2" scale="0 0 0">
                <!-- ... -->
            </a-entity>
            <!-- ... (resto de los grupos de puntos) ... -->
        </a-entity>

        <a-entity id="cam" camera position="0 1.6 0" look-controls>
            <a-entity 
                cursor="fuse: true; fuseTimeout:2000"
                geometry="primitive:ring;radiusInner:0.01;radiusOuter:0.02"
                position="0 0 -1.8"
                material="shader:flat;color:#ff0000;">
            </a-entity>

            <a-entity 
            cursor="rayOrigin: mouse"
            raycaster="objects: .interactivo"
            geometry="primitive:ring; radiusInner:0.01; radiusOuter:0.02"
            position="0 0 -1.8"
            material="shader:flat; color:#ff0000;">
        </a-entity>

        <a-entity position="-2 0.30 -1.5">
            <a-image class="logo" src="./images/LaPaz-logo1.png" position="0.75 0.30 -1.5" width="0.35" height="0.35"  material="" geometry=""></a-image>
        </a-entity>

        <a-entity position="0.3 0.30 -1.5">
            <a-image class="logo" src="./images/uabcs-logo.png" position="0.75 0.30 -1.5" width="0.30" height="0.30"  material="" geometry=""></a-image>
        </a-entity>
        </a-entity>
    </a-scene>
    
    <script>
        AFRAME.registerComponent('cubito', {
            init: function () {
                const cubo = document.querySelector('#cubo');

                // Detectar cuando el cubo es tocado
                cubo.addEventListener('grab-start', () => {
                    console.log('cubo tocado');
                    cubo.setAttribute('color', 'green');  // Cambiar el color a verde
                });

                // Detectar cuando el cubo deja de ser tocado
                cubo.addEventListener('grab-end', () => {
                    console.log('cubo dejado');
                    cubo.setAttribute('color', 'red');  // Volver a color rojo
                });
            }
        });
    </script>
    
    <script src="https://aframe.io/releases/1.6.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras/dist/aframe-extras.min.js"></script>
    <script src="js/hotspot.js"></script>
</body>
</html>